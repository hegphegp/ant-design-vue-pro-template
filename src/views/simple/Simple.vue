<template>
  <a-card :bordered="false">
    <a-table
      ref="table"
      :pagination="false"
      :columns="columns"
      :data-source="data"
      :row-selection="rowSelection"
      bordered>
      <span slot="action" slot-scope="text, record">
        <template>
          <a @click="queryDetail(record)">详情</a>
          <a-divider type="vertical" />
          <a @click="handleEdit(record)">编辑</a>
          <a-divider type="vertical" />
          <a @click="handleDelete(record.key)">删除</a>
        </template>
      </span>
    </a-table>
    <create-form ref="createModal" @refreshPage="refreshPage"/>
  </a-card>
</template>
<script>
import CreateForm from './components/CreateForm'

const columns = [
  { title: '名称', dataIndex: 'name' },
  { title: '编码', dataIndex: 'code', wkeyth: '12%' },
  { title: '操作', scopedSlots: { customRender: 'action' } }
]

const data = [{ 'key': '44', 'name': '广东省', 'code': '44', 'orderNo': 2, 'children': [{ 'key': '4403', 'name': '深圳市', 'code': '4403', 'orderNo': 2, 'parentkey': '44', 'children': [{ 'key': '440306', 'name': '宝安区', 'code': '440306', 'orderNo': 2, 'parentkey': '4403', 'children': [{ 'key': '440306006', 'name': '石岩街道', 'code': '440306006', 'orderNo': 1, 'parentkey': '440306', 'children': [{ 'key': '440306006007', 'name': '塘头社区', 'code': '440306006007', 'orderNo': 1, 'parentkey': '440306006', 'hasChild': false }, { 'key': '440306006008', 'name': '应人石社区', 'code': '440306006008', 'orderNo': 2, 'parentkey': '440306006', 'hasChild': false }, { 'key': '440306006009', 'name': '石龙社区', 'code': '440306006009', 'orderNo': 3, 'parentkey': '440306006', 'hasChild': false }, { 'key': '440306006010', 'name': '石岩龙腾社区', 'code': '440306006010', 'orderNo': 4, 'parentkey': '440306006', 'hasChild': false }, { 'key': '440306006001', 'name': '官田社区', 'code': '440306006001', 'orderNo': 120, 'parentkey': '440306006', 'hasChild': false }, { 'key': '440306006002', 'name': '浪心社区', 'code': '440306006002', 'orderNo': 121, 'parentkey': '440306006', 'hasChild': false }, { 'key': '440306006003', 'name': '罗租社区', 'code': '440306006003', 'orderNo': 122, 'parentkey': '440306006', 'hasChild': false }, { 'key': '440306006004', 'name': '上屋社区', 'code': '440306006004', 'orderNo': 123, 'parentkey': '440306006', 'hasChild': false }, { 'key': '440306006006', 'name': '水田社区', 'code': '440306006006', 'orderNo': 124, 'parentkey': '440306006', 'hasChild': false }, { 'key': '440306006011', 'name': '宝源社区', 'code': '440306006011', 'orderNo': 135, 'parentkey': '440306006', 'hasChild': false }], 'hasChild': true }, { 'key': '440306011', 'name': '新安街道', 'code': '440306011', 'orderNo': 2, 'parentkey': '440306', 'children': [{ 'key': '440306011001', 'name': '安乐社区', 'code': '440306011001', 'orderNo': 5, 'parentkey': '440306011', 'hasChild': false }, { 'key': '440306011002', 'name': '宝民社区', 'code': '440306011002', 'orderNo': 6, 'parentkey': '440306011', 'hasChild': false }, { 'key': '440306011003', 'name': '布心社区', 'code': '440306011003', 'orderNo': 7, 'parentkey': '440306011', 'hasChild': false }, { 'key': '440306011004', 'name': '大浪社区', 'code': '440306011004', 'orderNo': 8, 'parentkey': '440306011', 'hasChild': false }, { 'key': '440306011005', 'name': '翻身社区', 'code': '440306011005', 'orderNo': 9, 'parentkey': '440306011', 'hasChild': false }, { 'key': '440306011006', 'name': '海富社区', 'code': '440306011006', 'orderNo': 10, 'parentkey': '440306011', 'hasChild': false }, { 'key': '440306011007', 'name': '海华社区', 'code': '440306011007', 'orderNo': 11, 'parentkey': '440306011', 'hasChild': false }, { 'key': '440306011008', 'name': '海乐社区', 'code': '440306011008', 'orderNo': 12, 'parentkey': '440306011', 'hasChild': false }, { 'key': '440306011009', 'name': '海旺社区', 'code': '440306011009', 'orderNo': 13, 'parentkey': '440306011', 'hasChild': false }, { 'key': '440306011010', 'name': '海裕社区', 'code': '440306011010', 'orderNo': 14, 'parentkey': '440306011', 'hasChild': false }, { 'key': '440306011011', 'name': '洪浪社区', 'code': '440306011011', 'orderNo': 15, 'parentkey': '440306011', 'hasChild': false }, { 'key': '440306011012', 'name': '甲岸社区', 'code': '440306011012', 'orderNo': 16, 'parentkey': '440306011', 'hasChild': false }, { 'key': '440306011013', 'name': '建安社区', 'code': '440306011013', 'orderNo': 17, 'parentkey': '440306011', 'hasChild': false }, { 'key': '440306011014', 'name': '灵芝园社区', 'code': '440306011014', 'orderNo': 18, 'parentkey': '440306011', 'hasChild': false }, { 'key': '440306011015', 'name': '龙井社区', 'code': '440306011015', 'orderNo': 19, 'parentkey': '440306011', 'hasChild': false }, { 'key': '440306011016', 'name': '上川社区', 'code': '440306011016', 'orderNo': 20, 'parentkey': '440306011', 'hasChild': false }, { 'key': '440306011017', 'name': '上合社区', 'code': '440306011017', 'orderNo': 21, 'parentkey': '440306011', 'hasChild': false }, { 'key': '440306011018', 'name': '文汇社区', 'code': '440306011018', 'orderNo': 22, 'parentkey': '440306011', 'hasChild': false }, { 'key': '440306011019', 'name': '文雅社区', 'code': '440306011019', 'orderNo': 23, 'parentkey': '440306011', 'hasChild': false }, { 'key': '440306011020', 'name': '新安湖社区', 'code': '440306011020', 'orderNo': 24, 'parentkey': '440306011', 'hasChild': false }, { 'key': '440306011021', 'name': '新乐社区', 'code': '440306011021', 'orderNo': 25, 'parentkey': '440306011', 'hasChild': false }, { 'key': '440306011022', 'name': '兴东社区', 'code': '440306011022', 'orderNo': 26, 'parentkey': '440306011', 'hasChild': false }], 'hasChild': true }, { 'key': '440306012', 'name': '航城街道', 'code': '440306012', 'orderNo': 3, 'parentkey': '440306', 'children': [{ 'key': '440306012001', 'name': '黄麻布社区', 'code': '440306012001', 'orderNo': 27, 'parentkey': '440306012', 'hasChild': false }, { 'key': '440306012002', 'name': '九围社区', 'code': '440306012002', 'orderNo': 28, 'parentkey': '440306012', 'hasChild': false }, { 'key': '440306012003', 'name': '黄田社区', 'code': '440306012003', 'orderNo': 29, 'parentkey': '440306012', 'hasChild': false }, { 'key': '440306012004', 'name': '钟屋社区', 'code': '440306012004', 'orderNo': 30, 'parentkey': '440306012', 'hasChild': false }, { 'key': '440306012005', 'name': '鹤洲社区', 'code': '440306012005', 'orderNo': 31, 'parentkey': '440306012', 'hasChild': false }, { 'key': '440306012006', 'name': '后瑞社区', 'code': '440306012006', 'orderNo': 32, 'parentkey': '440306012', 'hasChild': false }, { 'key': '440306012007', 'name': '草围社区', 'code': '440306012007', 'orderNo': 33, 'parentkey': '440306012', 'hasChild': false }, { 'key': '440306012008', 'name': '三围社区', 'code': '440306012008', 'orderNo': 34, 'parentkey': '440306012', 'hasChild': false }, { 'key': '440306012009', 'name': '利锦社区', 'code': '440306012009', 'orderNo': 35, 'parentkey': '440306012', 'hasChild': false }, { 'key': '2c928099715a098b01715a662b5f752a', 'name': '鹤州社区', 'code': '440306012010', 'orderNo': 136, 'parentkey': '440306012', 'hasChild': false }], 'hasChild': true }, { 'key': '440306013', 'name': '福海街道', 'code': '440306013', 'orderNo': 4, 'parentkey': '440306', 'children': [{ 'key': '440306013001', 'name': '新和社区', 'code': '440306013001', 'orderNo': 36, 'parentkey': '440306013', 'hasChild': false }, { 'key': '440306013002', 'name': '桥头社区', 'code': '440306013002', 'orderNo': 37, 'parentkey': '440306013', 'hasChild': false }, { 'key': '440306013003', 'name': '和平社区', 'code': '440306013003', 'orderNo': 38, 'parentkey': '440306013', 'hasChild': false }, { 'key': '440306013004', 'name': '塘尾社区', 'code': '440306013004', 'orderNo': 39, 'parentkey': '440306013', 'hasChild': false }, { 'key': '440306013005', 'name': '新田社区', 'code': '440306013005', 'orderNo': 40, 'parentkey': '440306013', 'hasChild': false }, { 'key': '440306013006', 'name': '稔田社区', 'code': '440306013006', 'orderNo': 41, 'parentkey': '440306013', 'hasChild': false }, { 'key': '440306013007', 'name': '大洋社区', 'code': '440306013007', 'orderNo': 136, 'parentkey': '440306013', 'hasChild': false }], 'hasChild': true }, { 'key': '440306014', 'name': '新桥街道', 'code': '440306014', 'orderNo': 5, 'parentkey': '440306', 'children': [{ 'key': '440306014001', 'name': '新桥社区', 'code': '440306014001', 'orderNo': 42, 'parentkey': '440306014', 'hasChild': false }, { 'key': '440306014002', 'name': '新二社区', 'code': '440306014002', 'orderNo': 43, 'parentkey': '440306014', 'hasChild': false }, { 'key': '440306014003', 'name': '上星社区', 'code': '440306014003', 'orderNo': 44, 'parentkey': '440306014', 'hasChild': false }, { 'key': '440306014004', 'name': '上寮社区', 'code': '440306014004', 'orderNo': 45, 'parentkey': '440306014', 'hasChild': false }, { 'key': '440306014005', 'name': '黄埔社区', 'code': '440306014005', 'orderNo': 46, 'parentkey': '440306014', 'hasChild': false }, { 'key': '440306014006', 'name': '万丰社区', 'code': '440306014006', 'orderNo': 47, 'parentkey': '440306014', 'hasChild': false }, { 'key': '440306014007', 'name': '沙企社区', 'code': '440306014007', 'orderNo': 48, 'parentkey': '440306014', 'hasChild': false }], 'hasChild': true }, { 'key': '440306015', 'name': '燕罗街道', 'code': '440306015', 'orderNo': 6, 'parentkey': '440306', 'children': [{ 'key': '440306015001', 'name': '山门社区', 'code': '440306015001', 'orderNo': 49, 'parentkey': '440306015', 'hasChild': false }, { 'key': '440306015002', 'name': '洪桥头社区', 'code': '440306015002', 'orderNo': 50, 'parentkey': '440306015', 'hasChild': false }, { 'key': '440306015003', 'name': '燕川社区', 'code': '440306015003', 'orderNo': 51, 'parentkey': '440306015', 'hasChild': false }, { 'key': '440306015004', 'name': '罗田社区', 'code': '440306015004', 'orderNo': 52, 'parentkey': '440306015', 'hasChild': false }, { 'key': '440306015005', 'name': '塘下涌社区', 'code': '440306015005', 'orderNo': 53, 'parentkey': '440306015', 'hasChild': false }], 'hasChild': true }, { 'key': '440306001', 'name': '西乡街道', 'code': '440306001', 'orderNo': 7, 'parentkey': '440306', 'children': [{ 'key': '440306001002', 'name': '臣田社区', 'code': '440306001002', 'orderNo': 54, 'parentkey': '440306001', 'hasChild': false }, { 'key': '440306001003', 'name': '凤凰岗社区', 'code': '440306001003', 'orderNo': 55, 'parentkey': '440306001', 'hasChild': false }, { 'key': '440306001004', 'name': '福中福社区', 'code': '440306001004', 'orderNo': 56, 'parentkey': '440306001', 'hasChild': false }, { 'key': '440306001005', 'name': '富华社区', 'code': '440306001005', 'orderNo': 57, 'parentkey': '440306001', 'hasChild': false }, { 'key': '440306001006', 'name': '共乐社区', 'code': '440306001006', 'orderNo': 58, 'parentkey': '440306001', 'hasChild': false }, { 'key': '440306001007', 'name': '固戍社区', 'code': '440306001007', 'orderNo': 59, 'parentkey': '440306001', 'hasChild': false }, { 'key': '440306001008', 'name': '蚝业社区', 'code': '440306001008', 'orderNo': 60, 'parentkey': '440306001', 'hasChild': false }, { 'key': '440306001009', 'name': '河东社区', 'code': '440306001009', 'orderNo': 61, 'parentkey': '440306001', 'hasChild': false }, { 'key': '440306001010', 'name': '河西社区', 'code': '440306001010', 'orderNo': 62, 'parentkey': '440306001', 'hasChild': false }, { 'key': '440306001015', 'name': '径贝社区', 'code': '440306001015', 'orderNo': 63, 'parentkey': '440306001', 'hasChild': false }, { 'key': '440306001017', 'name': '劳动社区', 'code': '440306001017', 'orderNo': 64, 'parentkey': '440306001', 'hasChild': false }, { 'key': '440306001018', 'name': '乐群社区', 'code': '440306001018', 'orderNo': 65, 'parentkey': '440306001', 'hasChild': false }, { 'key': '440306001020', 'name': '流塘社区', 'code': '440306001020', 'orderNo': 66, 'parentkey': '440306001', 'hasChild': false }, { 'key': '440306001022', 'name': '西乡龙腾社区', 'code': '440306001022', 'orderNo': 67, 'parentkey': '440306001', 'hasChild': false }, { 'key': '440306001023', 'name': '龙珠社区', 'code': '440306001023', 'orderNo': 68, 'parentkey': '440306001', 'hasChild': false }, { 'key': '440306001024', 'name': '麻布社区', 'code': '440306001024', 'orderNo': 69, 'parentkey': '440306001', 'hasChild': false }, { 'key': '440306001026', 'name': '桃源社区', 'code': '440306001026', 'orderNo': 70, 'parentkey': '440306001', 'hasChild': false }, { 'key': '440306001027', 'name': '铁岗社区', 'code': '440306001027', 'orderNo': 71, 'parentkey': '440306001', 'hasChild': false }, { 'key': '440306001028', 'name': '西乡社区', 'code': '440306001028', 'orderNo': 72, 'parentkey': '440306001', 'hasChild': false }, { 'key': '440306001029', 'name': '盐田社区', 'code': '440306001029', 'orderNo': 73, 'parentkey': '440306001', 'hasChild': false }, { 'key': '440306001030', 'name': '渔业社区', 'code': '440306001030', 'orderNo': 74, 'parentkey': '440306001', 'hasChild': false }, { 'key': '440306001032', 'name': '庄边社区', 'code': '440306001032', 'orderNo': 75, 'parentkey': '440306001', 'hasChild': false }, { 'key': '440306001033', 'name': '南昌社区', 'code': '440306001033', 'orderNo': 76, 'parentkey': '440306001', 'hasChild': false }, { 'key': '440306001034', 'name': '永丰社区', 'code': '440306001034', 'orderNo': 77, 'parentkey': '440306001', 'hasChild': false }, { 'key': '440306001035', 'name': '固兴社区', 'code': '440306001035', 'orderNo': 78, 'parentkey': '440306001', 'hasChild': false }, { 'key': '2c9280997131cca50171562fa92a0ade', 'name': '柳竹社区', 'code': '440306001036', 'orderNo': 136, 'parentkey': '440306001', 'hasChild': false }], 'hasChild': true }, { 'key': '440306002', 'name': '福永街道', 'code': '440306002', 'orderNo': 8, 'parentkey': '440306', 'children': [{ 'key': '440306002001', 'name': '白石厦社区', 'code': '440306002001', 'orderNo': 79, 'parentkey': '440306002', 'hasChild': false }, { 'key': '440306002002', 'name': '凤凰社区', 'code': '440306002002', 'orderNo': 80, 'parentkey': '440306002', 'hasChild': false }, { 'key': '440306002003', 'name': '福围社区', 'code': '440306002003', 'orderNo': 81, 'parentkey': '440306002', 'hasChild': false }, { 'key': '440306002004', 'name': '福永社区', 'code': '440306002004', 'orderNo': 82, 'parentkey': '440306002', 'hasChild': false }, { 'key': '440306002006', 'name': '怀德社区', 'code': '440306002006', 'orderNo': 83, 'parentkey': '440306002', 'hasChild': false }, { 'key': '440306002007', 'name': '聚福社区', 'code': '440306002007', 'orderNo': 84, 'parentkey': '440306002', 'hasChild': false }, { 'key': '440306002013', 'name': '兴围社区', 'code': '440306002013', 'orderNo': 85, 'parentkey': '440306002', 'hasChild': false }], 'hasChild': true }, { 'key': '440306003', 'name': '沙井街道', 'code': '440306003', 'orderNo': 9, 'parentkey': '440306', 'children': [{ 'key': '440306003001', 'name': '步涌社区', 'code': '440306003001', 'orderNo': 86, 'parentkey': '440306003', 'hasChild': false }, { 'key': '440306003002', 'name': '大王山社区', 'code': '440306003002', 'orderNo': 87, 'parentkey': '440306003', 'hasChild': false }, { 'key': '440306003003', 'name': '东塘社区', 'code': '440306003003', 'orderNo': 88, 'parentkey': '440306003', 'hasChild': false }, { 'key': '440306003004', 'name': '共和社区', 'code': '440306003004', 'orderNo': 89, 'parentkey': '440306003', 'hasChild': false }, { 'key': '440306003005', 'name': '蚝二社区', 'code': '440306003005', 'orderNo': 90, 'parentkey': '440306003', 'hasChild': false }, { 'key': '440306003006', 'name': '蚝三社区', 'code': '440306003006', 'orderNo': 91, 'parentkey': '440306003', 'hasChild': false }, { 'key': '440306003007', 'name': '蚝四社区', 'code': '440306003007', 'orderNo': 92, 'parentkey': '440306003', 'hasChild': false }, { 'key': '440306003008', 'name': '蚝一社区', 'code': '440306003008', 'orderNo': 93, 'parentkey': '440306003', 'hasChild': false }, { 'key': '440306003009', 'name': '和一社区', 'code': '440306003009', 'orderNo': 94, 'parentkey': '440306003', 'hasChild': false }, { 'key': '440306003010', 'name': '后亭社区', 'code': '440306003010', 'orderNo': 95, 'parentkey': '440306003', 'hasChild': false }, { 'key': '440306003012', 'name': '马安山社区', 'code': '440306003012', 'orderNo': 96, 'parentkey': '440306003', 'hasChild': false }, { 'key': '440306003013', 'name': '民主社区', 'code': '440306003013', 'orderNo': 97, 'parentkey': '440306003', 'hasChild': false }, { 'key': '440306003014', 'name': '沙二社区', 'code': '440306003014', 'orderNo': 98, 'parentkey': '440306003', 'hasChild': false }, { 'key': '440306003015', 'name': '沙井社区', 'code': '440306003015', 'orderNo': 99, 'parentkey': '440306003', 'hasChild': false }, { 'key': '440306003016', 'name': '沙三社区', 'code': '440306003016', 'orderNo': 100, 'parentkey': '440306003', 'hasChild': false }, { 'key': '440306003017', 'name': '沙四社区', 'code': '440306003017', 'orderNo': 101, 'parentkey': '440306003', 'hasChild': false }, { 'key': '440306003018', 'name': '沙头社区', 'code': '440306003018', 'orderNo': 102, 'parentkey': '440306003', 'hasChild': false }, { 'key': '440306003019', 'name': '沙一社区', 'code': '440306003019', 'orderNo': 103, 'parentkey': '440306003', 'hasChild': false }, { 'key': '440306003022', 'name': '坣岗社区', 'code': '440306003022', 'orderNo': 104, 'parentkey': '440306003', 'hasChild': false }, { 'key': '440306003024', 'name': '辛养社区', 'code': '440306003024', 'orderNo': 105, 'parentkey': '440306003', 'hasChild': false }, { 'key': '440306003027', 'name': '衙边社区', 'code': '440306003027', 'orderNo': 106, 'parentkey': '440306003', 'hasChild': false }], 'hasChild': true }, { 'key': '440306004', 'name': '松岗街道', 'code': '440306004', 'orderNo': 10, 'parentkey': '440306', 'children': [{ 'key': '440306004001', 'name': '碧头社区', 'code': '440306004001', 'orderNo': 107, 'parentkey': '440306004', 'hasChild': false }, { 'key': '440306004002', 'name': '东方社区', 'code': '440306004002', 'orderNo': 108, 'parentkey': '440306004', 'hasChild': false }, { 'key': '440306004003', 'name': '红星社区', 'code': '440306004003', 'orderNo': 109, 'parentkey': '440306004', 'hasChild': false }, { 'key': '440306004005', 'name': '花果山社区', 'code': '440306004005', 'orderNo': 110, 'parentkey': '440306004', 'hasChild': false }, { 'key': '440306004006', 'name': '江边社区', 'code': '440306004006', 'orderNo': 111, 'parentkey': '440306004', 'hasChild': false }, { 'key': '440306004007', 'name': '朗下社区', 'code': '440306004007', 'orderNo': 112, 'parentkey': '440306004', 'hasChild': false }, { 'key': '440306004008', 'name': '楼岗社区', 'code': '440306004008', 'orderNo': 113, 'parentkey': '440306004', 'hasChild': false }, { 'key': '440306004010', 'name': '沙浦社区', 'code': '440306004010', 'orderNo': 114, 'parentkey': '440306004', 'hasChild': false }, { 'key': '440306004011', 'name': '沙浦围社区', 'code': '440306004011', 'orderNo': 115, 'parentkey': '440306004', 'hasChild': false }, { 'key': '440306004013', 'name': '松岗社区', 'code': '440306004013', 'orderNo': 116, 'parentkey': '440306004', 'hasChild': false }, { 'key': '440306004014', 'name': '松涛社区', 'code': '440306004014', 'orderNo': 117, 'parentkey': '440306004', 'hasChild': false }, { 'key': '440306004015', 'name': '潭头社区', 'code': '440306004015', 'orderNo': 118, 'parentkey': '440306004', 'hasChild': false }, { 'key': '440306004017', 'name': '溪头社区', 'code': '440306004017', 'orderNo': 119, 'parentkey': '440306004', 'hasChild': false }], 'hasChild': true }], 'hasChild': true }, { 'key': '8a74360973131ec30173135137d70086', 'name': '光明区', 'code': '440311', 'orderNo': 136, 'parentkey': '4403', 'hasChild': false }], 'hasChild': true }], 'hasChild': true }]

const rowSelection = {
  onChange: (selectedRowKeys, selectedRows) => {
    console.log(`selectedRowKeys: ${selectedRowKeys}`, 'selectedRows: ', selectedRows)
  },
  onSelect: (record, selected, selectedRows) => {
    console.log(record, selected, selectedRows)
  },
  onSelectAll: (selected, selectedRows, changeRows) => {
    console.log(selected, selectedRows, changeRows)
  }
}

export default {
  components: {
    CreateForm
  },
  data () {
    return {
      data,
      columns,
      rowSelection
    }
  },
  methods: {
    handleAdd () {
      this.$refs.createModal.openFormModal('add')
    },
    queryDetail (record) {
      this.$refs.createModal.openFormModal('detail')
    },
    handleEdit (record) {
      this.$refs.createModal.openFormModal('edit')
    },
    handleDelete (id) {
      console.log(id)
    },
    refreshPage (params) {
      console.log('modal传参到父控件')
      console.log(params)
      setTimeout(() => {
        const item = {
          key: new Date().getTime(),
          id: new Date().getTime(),
          name: '人名',
          age: 32,
          address: '地址'
        }
        this.data.push(item)
        // this.data = [...data, item]
        console.log('Simple.vue refreshPage()')
      }, 1000)
    }
  }
}
</script>
